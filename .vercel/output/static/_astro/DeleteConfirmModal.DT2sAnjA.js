import{w as M,a as C}from"./runtime-dom.esm-bundler.CxwZsN_f.js";import{s as m}from"./supabase.Br-sM2rM.js";import{_ as B}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{o as p,c as w,b as o,a as V,d as u,t as b,w as N,e as g,f as h,u as k,h as l}from"./runtime-core.esm-bundler.CuQQ-MJ5.js";const v=(r,e,i=3e3)=>{if(typeof window<"u"){const t=new CustomEvent("toast-notification",{detail:{message:r,type:e,duration:i}});window.dispatchEvent(t)}},G={success:(r,e=3e3)=>v(r,"success",e),error:(r,e=4e3)=>v(r,"error",e),info:(r,e=3e3)=>v(r,"info",e)},S={__name:"DeleteConfirmModal",props:{isOpen:Boolean,itemName:String},emits:["close","confirmed"],setup(r,{expose:e,emit:i}){e();const t=r,d=i,n=l(""),a=l(!1),c=l(""),f=l(null);h(()=>t.isOpen,s=>{s&&(n.value="",c.value="",k(()=>{f.value&&f.value.focus()}))});const x=()=>{d("close")},y={props:t,emit:d,password:n,verifying:a,errorMsg:c,passwordInput:f,close:x,confirm:async()=>{if(n.value){a.value=!0,c.value="";try{const{data:{user:s}}=await m.auth.getUser();if(!s||!s.email)throw new Error("ไม่พบข้อมูลผู้ใช้ กรุณาเข้าสู่ระบบใหม่");const{error:_}=await m.auth.signInWithPassword({email:s.email,password:n.value});if(_)throw new Error("รหัสผ่านไม่ถูกต้อง");d("confirmed"),x()}catch(s){c.value=s.message||"Verification failed"}finally{a.value=!1}}},ref:l,nextTick:k,watch:h,get supabase(){return m}};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}},j={key:0,class:"fixed inset-0 z-[100] flex items-center justify-center bg-black/90 p-4 backdrop-blur-sm"},z={class:"bg-gray-800 rounded-xl shadow-2xl w-full max-w-md border border-red-500/30 overflow-hidden"},D={class:"text-gray-300 text-sm mb-4"},E={class:"font-bold text-white"},O={key:0,class:"text-red-400 text-xs mt-1 flex items-center"},T={class:"flex gap-3 pt-2"},I=["disabled"],P=["disabled"],A={key:0,class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"};function L(r,e,i,t,d,n){return i.isOpen?(p(),w("div",j,[o("div",z,[e[7]||(e[7]=V('<div class="bg-red-900/20 p-4 border-b border-red-900/30 flex items-center gap-3"><div class="p-2 bg-red-500/20 rounded-full text-red-400"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg></div><h3 class="text-xl font-bold text-white">ยืนยันการลบข้อมูล</h3></div>',1)),o("form",{onSubmit:M(t.confirm,["prevent"]),class:"p-6 space-y-4"},[o("div",null,[o("p",D,[e[1]||(e[1]=u(" คุณกำลังจะลบ: ",-1)),o("span",E,'"'+b(i.itemName)+'"',1),e[2]||(e[2]=o("br",null,null,-1)),e[3]||(e[3]=u(" การกระทำนี้ไม่สามารถกู้คืนได้ เพื่อความปลอดภัยกรุณากรอกรหัสผ่านของคุณเพื่อยืนยัน ",-1))])]),o("div",null,[e[5]||(e[5]=o("label",{class:"block text-xs font-medium text-gray-400 mb-1"},"รหัสผ่านของคุณ (Admin Password)",-1)),N(o("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>t.password=a),type:"password",ref:"passwordInput",class:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2.5 text-white focus:border-red-500 focus:ring-1 focus:ring-red-500 focus:outline-none placeholder-gray-600",placeholder:"กรอกรหัสผ่าน...",required:""},null,512),[[C,t.password]]),t.errorMsg?(p(),w("p",O,[e[4]||(e[4]=o("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),u(" "+b(t.errorMsg),1)])):g("",!0)]),o("div",T,[o("button",{type:"button",onClick:t.close,class:"flex-1 px-4 py-2 bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-white rounded-lg transition-colors font-medium border border-gray-600 disabled:opacity-50",disabled:t.verifying}," ยกเลิก ",8,I),o("button",{type:"submit",class:"flex-1 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors font-medium flex justify-center items-center shadow-lg shadow-red-900/20 disabled:opacity-50 disabled:cursor-not-allowed",disabled:t.verifying||!t.password},[t.verifying?(p(),w("svg",A,[...e[6]||(e[6]=[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):g("",!0),u(" "+b(t.verifying?"กำลังตรวจสอบ...":"ยืนยันการลบ"),1)],8,P)])],32)])])):g("",!0)}const J=B(S,[["render",L]]);export{J as D,G as t};
